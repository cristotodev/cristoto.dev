---
import { getCollection } from "astro:content";
import BaseLayout from "@/layouts/Base.astro";
import PostPreview from "@/components/blog/PostPreview.astro";
import { siteConfig } from "@/site.config";
import { collectionDateSort } from "@/utils/date";

const title = "DevOps Moderno con Podman y Traefik";
const description = "Aprende DevOps moderno sin Docker: infraestructura rootless con Podman, proxy inteligente con Traefik, certificados SSL automÃ¡ticos y despliegues seguros para desarrolladores modernos.";

// Get all DevOps posts
const allPosts = await getCollection("post");
const devopsPosts = allPosts.filter(post => 
  post.id.startsWith('devops/') || 
  post.data.tags?.some(tag => ['podman', 'traefik', 'devops', 'contenedores', 'docker'].includes(tag.toLowerCase()))
).sort(collectionDateSort);

const meta = {
  title: `${title} â€¢ ${siteConfig.title}`,
  description,
  category: "devops",
  tags: ["devops", "podman", "traefik", "contenedores", "infraestructura", "rootless"]
};
---

<BaseLayout meta={meta}>
  <div class="container mx-auto px-4">
    
    <!-- Hero Section -->
    <header class="py-12 text-center">
      <h1 class="text-4xl md:text-5xl font-bold text-accent-base mb-6">
        ğŸš€ DevOps Moderno con Podman y Traefik
      </h1>
      <p class="text-xl text-light/80 max-w-4xl mx-auto leading-relaxed">
        Construye <strong>infraestructura moderna y segura</strong> sin dependencias de Docker. 
        Aprende a implementar contenedores rootless con Podman, proxy inteligente con Traefik, 
        y automatizaciÃ³n de certificados SSL para aplicaciones de producciÃ³n.
      </p>
      
      <div class="mt-8 flex flex-wrap justify-center gap-4">
        <div class="bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 px-4 py-2 rounded-full text-sm font-medium">
          âœ… Sin privilegios root
        </div>
        <div class="bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 px-4 py-2 rounded-full text-sm font-medium">
          ğŸ” HTTPS automÃ¡tico
        </div>
        <div class="bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-200 px-4 py-2 rounded-full text-sm font-medium">
          âš¡ Despliegues modernos
        </div>
      </div>
    </header>

    <!-- Why This Stack -->
    <section class="mb-12 bg-special-lighter border border-special-light rounded-lg p-8">
      <h2 class="text-2xl font-semibold text-accent-base mb-6">
        ğŸ¤” Â¿Por quÃ© Podman + Traefik en lugar de Docker?
      </h2>
      
      <div class="grid md:grid-cols-2 gap-8">
        <div>
          <h3 class="text-lg font-semibold mb-4 text-accent-base">ğŸ‹ Problemas con Docker Tradicional</h3>
          <ul class="space-y-2 text-light/80">
            <li class="flex items-start gap-2">
              <span class="text-red-500 mt-1">âŒ</span>
              <span>Requiere privilegios de root (riesgo de seguridad)</span>
            </li>
            <li class="flex items-start gap-2">
              <span class="text-red-500 mt-1">âŒ</span>
              <span>Daemon central (punto Ãºnico de fallo)</span>
            </li>
            <li class="flex items-start gap-2">
              <span class="text-red-500 mt-1">âŒ</span>
              <span>ConfiguraciÃ³n compleja de proxy y SSL</span>
            </li>
            <li class="flex items-start gap-2">
              <span class="text-red-500 mt-1">âŒ</span>
              <span>GestiÃ³n manual de certificados</span>
            </li>
          </ul>
        </div>

        <div>
          <h3 class="text-lg font-semibold mb-4 text-accent-base">ğŸš€ Ventajas del Stack Moderno</h3>
          <ul class="space-y-2 text-light/80">
            <li class="flex items-start gap-2">
              <span class="text-green-500 mt-1">âœ…</span>
              <span><strong>Podman rootless:</strong> Contenedores sin root</span>
            </li>
            <li class="flex items-start gap-2">
              <span class="text-green-500 mt-1">âœ…</span>
              <span><strong>Sin daemon:</strong> Cada contenedor es independiente</span>
            </li>
            <li class="flex items-start gap-2">
              <span class="text-green-500 mt-1">âœ…</span>
              <span><strong>Traefik automÃ¡tico:</strong> Descubrimiento dinÃ¡mico</span>
            </li>
            <li class="flex items-start gap-2">
              <span class="text-green-500 mt-1">âœ…</span>
              <span><strong>SSL automÃ¡tico:</strong> Let's Encrypt integrado</span>
            </li>
          </ul>
        </div>
      </div>
    </section>

    <!-- Learning Path -->
    <section class="mb-12">
      <h2 class="text-2xl font-semibold text-accent-base mb-8 flex items-center gap-2">
        ğŸ¯ Ruta de Aprendizaje DevOps Moderno
      </h2>
      
      <div class="grid md:grid-cols-3 gap-6">
        <!-- Fundamentos -->
        <div class="bg-special-lighter border border-special-light rounded-lg p-6">
          <h3 class="text-lg font-semibold text-accent-base mb-4">
            ğŸ—ï¸ Fundamentos Podman
          </h3>
          <ul class="space-y-2 text-light/80 text-sm">
            <li>â€¢ InstalaciÃ³n y configuraciÃ³n rootless</li>
            <li>â€¢ Comandos bÃ¡sicos vs Docker</li>
            <li>â€¢ Podman Compose para servicios</li>
            <li>â€¢ GestiÃ³n de imÃ¡genes y volÃºmenes</li>
            <li>â€¢ Networking entre contenedores</li>
          </ul>
        </div>

        <!-- Proxy Inteligente -->
        <div class="bg-special-lighter border border-special-light rounded-lg p-6">
          <h3 class="text-lg font-semibold text-accent-base mb-4">
            ğŸ”€ Proxy con Traefik
          </h3>
          <ul class="space-y-2 text-light/80 text-sm">
            <li>â€¢ ConfiguraciÃ³n inicial de Traefik</li>
            <li>â€¢ Descubrimiento automÃ¡tico de servicios</li>
            <li>â€¢ Routing dinÃ¡mico por dominio</li>
            <li>â€¢ Dashboard de monitorizaciÃ³n</li>
            <li>â€¢ Middleware para autenticaciÃ³n</li>
          </ul>
        </div>

        <!-- ProducciÃ³n -->
        <div class="bg-special-lighter border border-special-light rounded-lg p-6">
          <h3 class="text-lg font-semibold text-accent-base mb-4">
            ğŸ›¡ï¸ ProducciÃ³n Segura
          </h3>
          <ul class="space-y-2 text-light/80 text-sm">
            <li>â€¢ Certificados SSL automÃ¡ticos</li>
            <li>â€¢ AutenticaciÃ³n y autorizaciÃ³n</li>
            <li>â€¢ MonitorizaciÃ³n y logging</li>
            <li>â€¢ Backup y disaster recovery</li>
            <li>â€¢ Escalado horizontal</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- Quick Commands Reference -->
    <section class="mb-12 bg-special-lighter border border-special-light rounded-lg p-8">
      <h2 class="text-2xl font-semibold text-accent-base mb-6">
        âš¡ Comandos Esenciales
      </h2>
      
      <div class="grid md:grid-cols-2 gap-8">
        <div>
          <h3 class="text-lg font-semibold mb-4 text-accent-base">Podman BÃ¡sico</h3>
          <div class="bg-bgColor rounded-lg p-4 font-mono text-sm">
            <div class="mb-2 text-gray-400"># Ejecutar contenedor</div>
            <div class="mb-3">podman run -d --name webapp nginx</div>
            <div class="mb-2 text-gray-400"># Listar contenedores</div>
            <div class="mb-3">podman ps -a</div>
            <div class="mb-2 text-gray-400"># Ver logs</div>
            <div>podman logs -f webapp</div>
          </div>
        </div>
        
        <div>
          <h3 class="text-lg font-semibold mb-4 text-accent-base">Podman Compose</h3>
          <div class="bg-bgColor rounded-lg p-4 font-mono text-sm">
            <div class="mb-2 text-gray-400"># Levantar servicios</div>
            <div class="mb-3">podman-compose up -d</div>
            <div class="mb-2 text-gray-400"># Ver estado</div>
            <div class="mb-3">podman-compose ps</div>
            <div class="mb-2 text-gray-400"># Parar servicios</div>
            <div>podman-compose down</div>
          </div>
        </div>
      </div>
    </section>

    <!-- Architecture Diagram -->
    <section class="mb-12">
      <h2 class="text-2xl font-semibold text-accent-base mb-6">
        ğŸ›ï¸ Arquitectura de la Infraestructura
      </h2>
      
      <div class="bg-special-lighter border border-special-light rounded-lg p-8">
        <div class="text-center mb-6">
          <div class="inline-block bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 px-4 py-2 rounded-lg font-medium">
            ğŸŒ Internet / Usuarios
          </div>
        </div>
        
        <div class="text-center mb-6">
          <div class="text-2xl mb-2">â¬‡ï¸</div>
          <div class="inline-block bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 px-6 py-3 rounded-lg font-medium">
            ğŸ”€ Traefik Proxy<br/>
            <span class="text-sm opacity-80">(SSL + Routing + Auth)</span>
          </div>
        </div>
        
        <div class="grid md:grid-cols-3 gap-4 mb-6">
          <div class="text-center">
            <div class="text-2xl mb-2">â¬‡ï¸</div>
            <div class="bg-cyan-100 dark:bg-cyan-700 text-cyan-800 dark:text-cyan-50 px-4 py-3 rounded-lg border border-cyan-200 dark:border-cyan-600">
              ğŸ“± App Web<br/>
              <span class="text-sm opacity-80">React/Vue/etc</span>
            </div>
          </div>
          <div class="text-center">
            <div class="text-2xl mb-2">â¬‡ï¸</div>
            <div class="bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 px-4 py-3 rounded-lg">
              ğŸ”§ API Backend<br/>
              <span class="text-sm opacity-80">Node.js/Python/Go</span>
            </div>
          </div>
          <div class="text-center">
            <div class="text-2xl mb-2">â¬‡ï¸</div>
            <div class="bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200 px-4 py-3 rounded-lg">
              ğŸ—„ï¸ Base de Datos<br/>
              <span class="text-sm opacity-80">PostgreSQL/MySQL</span>
            </div>
          </div>
        </div>
        
        <div class="text-center">
          <div class="inline-block bg-gray-100 dark:bg-gray-800 text-gray-800 dark:text-gray-200 px-4 py-2 rounded-lg text-sm">
            ğŸ§ Host Linux (sin privilegios root)
          </div>
        </div>
      </div>
    </section>

    <!-- Tutorials List -->
    <section class="mb-12">
      <div class="flex items-center justify-between mb-8">
        <h2 class="text-2xl font-semibold text-accent-base">
          ğŸ“š Todos los Tutoriales DevOps
        </h2>
        <span class="bg-accent-base/10 text-accent-base px-3 py-1 rounded-full text-sm font-medium">
          {devopsPosts.length} tutoriales
        </span>
      </div>

      {devopsPosts.length === 0 ? (
        <p class="text-light/60">PrÃ³ximamente mÃ¡s tutoriales de DevOps...</p>
      ) : (
        <div class="grid gap-6">
          {devopsPosts.map((post) => (
            <PostPreview post={post} withDesc={true} />
          ))}
        </div>
      )}
    </section>

    <!-- FAQ Section -->
    <section class="mb-12 bg-special-lighter border border-special-light rounded-lg p-8">
      <h2 class="text-2xl font-semibold text-accent-base mb-8">
        â“ Preguntas Frecuentes sobre DevOps Moderno
      </h2>
      
      <div class="space-y-6">
        <div>
          <h3 class="text-lg font-semibold mb-2 text-accent-base">Â¿Por quÃ© usar Podman en lugar de Docker?</h3>
          <p class="text-light/80">
            <strong>Podman es mÃ¡s seguro</strong> porque no requiere privilegios de root ni un daemon central. 
            Cada contenedor funciona como un proceso normal del usuario, reduciendo vectores de ataque. 
            AdemÃ¡s, es compatible con Docker (mismo API) pero sin los riesgos de seguridad.
          </p>
        </div>

        <div>
          <h3 class="text-lg font-semibold mb-2 text-accent-base">Â¿Traefik es difÃ­cil de configurar?</h3>
          <p class="text-light/80">
            Al contrario, <strong>Traefik simplifica la configuraciÃ³n</strong> comparado con Nginx o Apache. 
            Detecta automÃ¡ticamente tus servicios, genera certificados SSL, y maneja el routing dinÃ¡micamente. 
            Una vez configurado, prÃ¡cticamente se gestiona solo.
          </p>
        </div>

        <div>
          <h3 class="text-lg font-semibold mb-2 text-accent-base">Â¿Necesito conocimientos avanzados de Linux?</h3>
          <p class="text-light/80">
            <strong>No</strong>. Mis tutoriales estÃ¡n diseÃ±ados para desarrolladores que quieren aprender DevOps paso a paso. 
            Empezamos con lo bÃ¡sico y avanzamos gradualmente. Solo necesitas saber usar la terminal y conceptos bÃ¡sicos de contenedores.
          </p>
        </div>

        <div>
          <h3 class="text-lg font-semibold mb-2 text-accent-base">Â¿Esta infraestructura sirve para producciÃ³n?</h3>
          <p class="text-light/80">
            <strong>Absolutamente</strong>. Esta stack es usado por empresas en producciÃ³n. Podman rootless + Traefik 
            ofrece mejor seguridad que Docker tradicional, SSL automÃ¡tico, y escalabilidad horizontal. 
            Es ideal para aplicaciones web modernas.
          </p>
        </div>

        <div>
          <h3 class="text-lg font-semibold mb-2 text-accent-base">Â¿QuÃ© ventajas tiene sobre Kubernetes?</h3>
          <p class="text-light/80">
            <strong>Simplicidad y menor overhead</strong>. Kubernetes es excelente para aplicaciones masivas, 
            pero para proyectos pequeÃ±os/medianos es excesivo. Esta stack te da el 80% de beneficios con 20% de la complejidad.
          </p>
        </div>
      </div>
    </section>

    <!-- Call to Action -->
    <section class="text-center py-12">
      <h2 class="text-2xl font-semibold text-accent-base mb-4">
        ğŸš€ Â¿Listo para modernizar tu infraestructura?
      </h2>
      <p class="text-lg text-light/80 mb-6 max-w-3xl mx-auto">
        Empieza con nuestro tutorial de <strong>infraestructura moderna con Podman y Traefik</strong> 
        y construye aplicaciones seguras, escalables y fÃ¡ciles de mantener.
      </p>
      <div class="flex flex-wrap justify-center gap-4">
        <a 
          href="/posts/devops/infraestructura-moderna-podman-traefik/" 
          class="inline-flex items-center gap-2 bg-accent-base text-white px-6 py-3 rounded-lg font-medium hover:bg-accent-base/90 transition-colors"
        >
          ğŸ“– Empezar Tutorial
        </a>
        <a 
          href="/services/" 
          class="inline-flex items-center gap-2 border border-accent-base text-accent-base px-6 py-3 rounded-lg font-medium hover:bg-accent-base/10 transition-colors"
        >
          ğŸ’¼ ConsultorÃ­a DevOps
        </a>
      </div>
    </section>

  </div>
</BaseLayout>

<!-- FAQ Schema -->
<script type="application/ld+json" set:html={JSON.stringify({
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {
      "@type": "Question",
      "name": "Â¿Por quÃ© usar Podman en lugar de Docker?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Podman es mÃ¡s seguro porque no requiere privilegios de root ni un daemon central. Cada contenedor funciona como un proceso normal del usuario, reduciendo vectores de ataque."
      }
    },
    {
      "@type": "Question", 
      "name": "Â¿Traefik es difÃ­cil de configurar?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Al contrario, Traefik simplifica la configuraciÃ³n comparado con Nginx o Apache. Detecta automÃ¡ticamente servicios, genera certificados SSL, y maneja routing dinÃ¡micamente."
      }
    },
    {
      "@type": "Question",
      "name": "Â¿Necesito conocimientos avanzados de Linux?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "No. Los tutoriales estÃ¡n diseÃ±ados para desarrolladores que quieren aprender DevOps paso a paso, empezando con lo bÃ¡sico."
      }
    },
    {
      "@type": "Question",
      "name": "Â¿Esta infraestructura sirve para producciÃ³n?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Absolutamente. Esta stack es usado por empresas en producciÃ³n. Podman rootless + Traefik ofrece mejor seguridad que Docker tradicional."
      }
    }
  ]
}, null, 0)} />

<!-- Course Schema -->
<script type="application/ld+json" set:html={JSON.stringify({
  "@context": "https://schema.org",
  "@type": "Course",
  "name": "DevOps Moderno con Podman y Traefik",
  "description": "Aprende DevOps moderno: infraestructura rootless con Podman, proxy inteligente con Traefik, certificados SSL automÃ¡ticos y despliegues seguros.",
  "provider": {
    "@type": "Organization",
    "name": "Cristotodev",
    "url": "https://cristoto.dev"
  },
  "educationalLevel": "Intermediate to Advanced",
  "courseMode": "online",
  "inLanguage": "es",
  "teaches": [
    "Podman rootless containers",
    "Traefik proxy configuration", 
    "SSL certificate automation",
    "Modern deployment strategies",
    "Container orchestration"
  ]
}, null, 0)} />